$def with (dia, sys, targetdia, targetsys, percent_under, percent_over)
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" /> 
  <title>Charts</title> 
  <link rel="stylesheet" href="/static/all.css" type="text/css" media="screen" title="no title" />
  <style type="text/css" media="screen">
  </style>
  <script type="text/javascript" src="/static/d3.js"></script>
</head> 
<body> 
<div id="wrapper" class="">
  <div id="header">   
    <div class="container">
      <div class="grid grid_24">
        <ul>              
          <li class="nav">            
            <a href="../dashboard.html" class="item icon"><span>Home</span></a>         
          </li> 
          <li class="bar"></li>
          <li class="nav dropdown">           
            <a href="javascript:;" class="item">About Us</a>  
            <div class="menu">            
              <h3>Custom Pages</h3>
              <ul>
                <li><a href="../pages/blank.html">Blank Slate</a></li>
                <li><a href="../pages/gallery.html">Image Gallery</a></li>
                <li><a href="../pages/reports.html">Reports</a></li>
              </ul>
            </div>        
          </li>
          <li class="nav dropdown">           
            <a href="javascript:;" class="item">F . A . Q. </a>
            <div class="menu">              
              <h3>Custom Elements</h3>
              <ul>
                <li><a href="../pages/themes.html">Theme Gallery</a></li>
                <li><a href="../pages/grid.html">Grid</a></li>
                <li><a href="../pages/forms.html">Forms</a></li>
                <li><a href="../pages/text.html">Buttons & Text</a></li>
              </ul>
            </div>            
          </li>
          <li class="nav profile dropdown right">           
            <a href="javascript:;" class="item"><img src="/static/images/layout/nav_profile_image.png" alt="Profile Image" /></a>  
            <div class="menu">  
              <h3>Preferences</h3>
              <ul>
                <li><a href="../pages/settings.html">Account Settings</a></li>
                <li><a href="../pages/upgrade.html">Update Health Info</a></li>
              </ul>
              <hr />
              <ul>
                <li><a href="../login.html">Logout</a></li>
              </ul>
            </div>
          </li>
          <li class="bar right"></li>     
        </ul> 
      </div> <!-- .grid -->
    </div> <!-- .container -->
  </div> <!-- #header -->
  <div id="sub-header">   
    <div class="container">
      <div class="grid grid_24">
        <h2>The Future Me</h2>        
      </div> <!-- .grid -->     
    </div> <!-- .container -->
  </div> <!-- #sub-header -->
  <div id="content" class="">       
    <div class="container">     
      <div class="grid grid_12">
        <h2>Your Future</h2>
        <p>With Blood Pressure of 
        $code:
            def maketext():
             if dia >= targetdia or sys >= targetsys:
                 return "<font color=red>" + str(sys) + " / " + str(dia) + "</font><br>\nTarget: " + str(targetsys) + " / " + str(targetdia)
             else:
                return "<font color=green> " + str(sys) + " / " + str(dia) + " </font>"
        $:maketext()
        </p>
        <a href="javascript:onControlMyBloodPressure();" class="btn large blue" id="controlmybloodpressure">Control My blood pressure</a>
        <a href="/static/education.html" class="btn large blue" style="visibility:hidden" id="learnmorebutton">Learn More!</a>
      </div> <!-- .grid --><!-- .grid --></div> <!-- .container -->
        <p><div class="container" id="chartwin" /></p>
  </div> <!-- #content -->
  <div id="footer" class="cf"><!-- .container -->
  </div> <!-- #footer -->
</div> <!-- #wrapper -->
<script src="/static/all.js"></script>
<script type="text/javascript">
    var onControlMyBloodPressure = function() {
       data = $percent_under;
       /*chart.selectAll("rect")
           .data(data2)
           .enter().append("svg:rect")
           .attr("x", 0)
           .attr("y", 0)
           .attr("width", 30)
           .attr("height", 30)
           .attr("fill: red")
           .attr("opacity", 0.7);*/
       chart.selectAll("rect")
            .data(data)
            .transition()
            .duration(1000)
            .attr("y", function(d) {return height - d*height; })
            .attr("width", width - 50)
            .attr("height", function(d) {return d*height; })
            .attr("fill", "green")
            .attr("opacity", 0.7);
        chart.selectAll("text")
            .data(data)
            .text(function (d, i) { return ["Healthy ("+Math.round(d*100)+" %)","Heart Disease ("+Math.round(d*100)+" %)", "Stroke ("+Math.round(d*100)+" %)", "Kidney Problems ("+Math.round(d*100)+" %)"][i]; });
        document.getElementById("learnmorebutton").style.visibility="";
        document.getElementById("controlmybloodpressure").style.visibility="hidden";
    }
    var width = 300;
    var height = 400;
    var data = $percent_over;
    var chart = d3.select("div#chartwin")
      .append("svg:svg")
        .attr("class", "chart")
        .attr("width", width * data.length)
        .attr("height", height);
    var x = d3.scale.ordinal()
        .domain(data)
        .range([0, width * data.length])
    var y = d3.scale.linear()
        .domain([0, d3.max(data)])
        .range([0, height]);
//   chart.selectAll("rect")
//       .data(data2)
//         .enter().append("svg:rect")
//            .attr("x", function(d, i) { return i * width; })
//            .attr("y", function(d) { return height - d; })
//            .attr("width", width)
//            .attr("height", function(d) { return d; })
//            .attr("fill", "red")
//            .attr("opacity", 0.0);
    chart.selectAll("rect")
      .data(data)
        .enter().append("svg:rect")
          .attr("x", function(d, i) { return i * width; })
          .attr("y", function(d) { return height - d*height; })
          .attr("width", width-50)
          .attr("height", function(d) { return d*height; })
          .attr("fill", "red")
          .attr("opacity", 0.7);
    chart.selectAll("text")
    .data(data)
    .enter().append("svg:text")
    .attr("x", function(d, i) { return i * width; })
    .attr("y", function(d, i) { return height - d; })
    .attr("dy", -height + 100)
    .attr("font-size", 16)
    .attr("dx", 3)
    //.attr(
    .attr("text-anchor", "center")
    .text(function (d, i) { return ["Healthy ("+Math.round(d*100)+" %)","Heart Disease ("+Math.round(d*100)+" %)", "Stroke ("+Math.round(d*100)+" %)", "Kidney Problems ("+Math.round(d*100)+" %)"][i]; });
</script>
</body>
</html>

